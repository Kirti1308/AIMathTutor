<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MathMind AI - Adaptive Personal Tutor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Slate-50 */
            color: #1e293b; /* Slate-800 */
        }

        /* Chart Container Styling - MANDATORY per requirements */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Custom Scrollbar for chat area */
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .btn-hover {
            transition: all 0.2s ease;
        }
        .btn-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
    </style>
    <!-- Chosen Palette: Warm Neutrals (Slate/Zinc) with Indigo accents for a calm, academic feel. -->
    <!-- Application Structure Plan:
         1. Header: Branding and Global Stats.
         2. Main Grid:
            - Left Column: "The Tutor" (Interactive Problem Solving & Chat Interface).
            - Right Column: "The Analyst" (Data Visualization & Topic Selection).
         3. Logic:
            - Central "AI" Engine generates problems based on selected topic and current difficulty.
            - State Manager tracks history for Chart.js updates.
         4. Justification: Split view allows users to learn (do math) while immediately seeing the impact of their work (data/charts), reinforcing the feedback loop.
    -->
    <!-- Visualization & Content Choices:
         - Line Chart: To show learning velocity (Accuracy over last 10 attempts). Goal: Change/Improvement.
         - Doughnut Chart: To show Topic Mastery breakdown. Goal: Inform/Status.
         - Textual Feedback: Dynamic HTML blocks for "AI Explanations". Goal: Inform.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-slate-50 min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="bg-white border-b border-slate-200 shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl mr-2">üß†</span>
                    <h1 class="text-xl font-bold text-slate-800 tracking-tight">MathMind<span class="text-indigo-600">AI</span></h1>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="hidden md:flex flex-col items-end">
                        <span class="text-xs text-slate-500 uppercase font-semibold tracking-wider">Session Score</span>
                        <span id="global-score" class="text-lg font-bold text-indigo-600">0</span>
                    </div>
                    <a href="https://github.com" target="_blank" class="text-slate-400 hover:text-slate-600 transition-colors">
                        <span class="text-2xl">üìÇ</span> <!-- Folder icon representing Repo -->
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow max-w-7xl w-full mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Intro Section -->
        <div class="mb-8">
            <h2 class="text-2xl font-bold text-slate-800 mb-2">Your Adaptive Learning Workspace</h2>
            <p class="text-slate-600 max-w-3xl">
                Welcome to your personal AI tutor. Select a domain to begin. The system analyzes your performance in real-time, adjusting difficulty and providing visual feedback on your learning curve.
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            <!-- LEFT COLUMN: Interaction Zone (The Tutor) -->
            <section class="lg:col-span-7 flex flex-col gap-6">
                
                <!-- Topic Selector -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                    <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wider mb-4">Select Domain</h3>
                    <div class="grid grid-cols-3 gap-4">
                        <button onclick="app.setTopic('arithmetic')" id="btn-arithmetic" class="btn-hover flex flex-col items-center justify-center p-4 rounded-lg border-2 border-indigo-100 bg-indigo-50 text-indigo-700 transition-colors ring-2 ring-indigo-500 ring-offset-2">
                            <span class="text-2xl mb-2">‚ûï</span>
                            <span class="font-medium">Arithmetic</span>
                        </button>
                        <button onclick="app.setTopic('algebra')" id="btn-algebra" class="btn-hover flex flex-col items-center justify-center p-4 rounded-lg border-2 border-slate-100 bg-white text-slate-600 hover:bg-slate-50 transition-colors">
                            <span class="text-2xl mb-2">‚úñÔ∏è</span>
                            <span class="font-medium">Algebra</span>
                        </button>
                        <button onclick="app.setTopic('geometry')" id="btn-geometry" class="btn-hover flex flex-col items-center justify-center p-4 rounded-lg border-2 border-slate-100 bg-white text-slate-600 hover:bg-slate-50 transition-colors">
                            <span class="text-2xl mb-2">üìê</span>
                            <span class="font-medium">Geometry</span>
                        </button>
                    </div>
                </div>

                <!-- AI Interaction Interface -->
                <div class="bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden flex flex-col h-[500px]">
                    <!-- Header -->
                    <div class="bg-slate-800 text-white px-6 py-4 flex justify-between items-center">
                        <div class="flex items-center gap-2">
                            <div class="w-2 h-2 rounded-full bg-green-400 animate-pulse"></div>
                            <span class="font-semibold">Tutor Bot Active</span>
                        </div>
                        <span id="difficulty-badge" class="px-2 py-1 bg-slate-700 rounded text-xs text-slate-300">Level 1</span>
                    </div>

                    <!-- Chat/Problem Area -->
                    <div id="chat-area" class="flex-grow p-6 overflow-y-auto bg-slate-50 space-y-4">
                        <!-- AI Message -->
                        <div class="flex gap-4 fade-in">
                            <div class="w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center text-xl flex-shrink-0">ü§ñ</div>
                            <div class="bg-white p-4 rounded-2xl rounded-tl-none shadow-sm border border-slate-200 max-w-[85%]">
                                <p class="text-slate-700">Hello! I'm ready to help you master mathematics. I've selected an <span class="font-bold text-indigo-600">Arithmetic</span> problem to start. Ready?</p>
                            </div>
                        </div>

                        <!-- Problem Display -->
                        <div id="problem-card" class="mx-auto w-full max-w-md bg-white border-l-4 border-indigo-500 p-6 shadow-md rounded-r-lg my-4 fade-in">
                            <p class="text-xs text-slate-400 uppercase font-bold mb-1">Problem #<span id="problem-id">1</span></p>
                            <h3 id="problem-text" class="text-2xl font-bold text-slate-800 mb-4">What is 12 + 15?</h3>
                            
                            <div class="flex gap-2">
                                <input type="number" id="user-answer" placeholder="Your answer..." 
                                    class="flex-grow px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-shadow"
                                    onkeypress="if(event.key === 'Enter') app.submitAnswer()">
                                <button onclick="app.submitAnswer()" class="bg-indigo-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-indigo-700 transition-colors">
                                    Check
                                </button>
                            </div>
                            <div class="mt-3 flex justify-between items-center">
                                <button onclick="app.requestHint()" class="text-sm text-indigo-600 hover:text-indigo-800 underline decoration-dashed">
                                    Need a hint?
                                </button>
                                <span id="feedback-msg" class="text-sm font-bold"></span>
                            </div>
                        </div>
                        
                        <!-- Dynamic History will be appended here -->
                    </div>
                </div>

            </section>

            <!-- RIGHT COLUMN: The Analyst (Visualizations) -->
            <section class="lg:col-span-5 flex flex-col gap-6">
                
                <!-- Performance Overview -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                    <div class="mb-4">
                        <h3 class="text-lg font-bold text-slate-800">Learning Velocity</h3>
                        <p class="text-sm text-slate-500">Your accuracy over the last 10 attempts.</p>
                    </div>
                    
                    <!-- Chart Container 1 -->
                    <div class="chart-container">
                        <canvas id="velocityChart"></canvas>
                    </div>
                </div>

                <!-- Mastery Distribution -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                    <div class="mb-4">
                        <h3 class="text-lg font-bold text-slate-800">Topic Mastery</h3>
                        <p class="text-sm text-slate-500">Distribution of correctly solved problems.</p>
                    </div>

                    <!-- Chart Container 2 -->
                    <div class="chart-container" style="height: 250px;">
                        <canvas id="masteryChart"></canvas>
                    </div>
                </div>

                <!-- Stats Grid -->
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-emerald-50 p-4 rounded-xl border border-emerald-100">
                        <span class="block text-2xl mb-1">üî•</span>
                        <p class="text-xs text-emerald-600 font-bold uppercase">Current Streak</p>
                        <p id="streak-display" class="text-2xl font-bold text-emerald-800">0</p>
                    </div>
                    <div class="bg-amber-50 p-4 rounded-xl border border-amber-100">
                        <span class="block text-2xl mb-1">üéì</span>
                        <p class="text-xs text-amber-600 font-bold uppercase">Total Solved</p>
                        <p id="total-solved-display" class="text-2xl font-bold text-amber-800">0</p>
                    </div>
                </div>

            </section>
        </div>
    </main>

    <footer class="bg-white border-t border-slate-200 mt-12 py-8">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-slate-400 text-sm">
                Generated for Github Project use. "MathMind AI" uses local-logic algorithms to simulate an adaptive tutor.
            </p>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        /**
         * MathMind AI - Core Application Logic
         * Handles problem generation, user interaction, state management, and Chart.js visualization.
         */
        const app = {
            state: {
                currentTopic: 'arithmetic',
                difficulty: 1, // 1 to 5
                streak: 0,
                totalSolved: 0,
                history: [], // Stores last 10 results (1 for correct, 0 for wrong)
                mastery: {
                    arithmetic: 0,
                    algebra: 0,
                    geometry: 0
                },
                currentProblem: null
            },

            // Charts instances
            velocityChart: null,
            masteryChart: null,

            init: function() {
                this.initCharts();
                this.generateProblem();
                this.updateUI();
            },

            // --- Problem Generation Engine ---
            generateProblem: function() {
                const topic = this.state.currentTopic;
                const level = this.state.difficulty;
                let problem = {};

                if (topic === 'arithmetic') {
                    const ops = ['+', '-', '*'];
                    const op = ops[Math.floor(Math.random() * (level >= 3 ? 3 : 2))]; // Introduce * at level 3
                    const maxVal = level * 10;
                    const a = Math.floor(Math.random() * maxVal) + 1;
                    const b = Math.floor(Math.random() * maxVal) + 1;
                    
                    if (op === '+') {
                        problem = { 
                            text: `What is ${a} + ${b}?`, 
                            answer: a + b, 
                            hint: `Try counting up from ${Math.max(a, b)}.` 
                        };
                    } else if (op === '-') {
                        let larger = Math.max(a, b);
                        let smaller = Math.min(a, b);
                        problem = { 
                            text: `What is ${larger} - ${smaller}?`, 
                            answer: larger - smaller, 
                            hint: `What number added to ${smaller} gives ${larger}?` 
                        };
                    } else {
                        problem = { 
                            text: `What is ${a} √ó ${b}?`, 
                            answer: a * b, 
                            hint: `This is the same as adding ${a} to itself ${b} times.` 
                        };
                    }
                } else if (topic === 'algebra') {
                    const a = Math.floor(Math.random() * 5 * level) + 1;
                    const x = Math.floor(Math.random() * 10) + 1;
                    const b = Math.floor(Math.random() * 20) + 1;
                    const c = (a * x) + b;
                    
                    problem = {
                        text: `Solve for x: ${a}x + ${b} = ${c}`,
                        answer: x,
                        hint: `First, subtract ${b} from both sides. Then divide by ${a}.`
                    };
                } else if (topic === 'geometry') {
                    // Area of Rectangle
                    const w = Math.floor(Math.random() * 5 * level) + 2;
                    const h = Math.floor(Math.random() * 5 * level) + 2;
                    problem = {
                        text: `Find the Area of a rectangle with width ${w} and height ${h}.`,
                        answer: w * h,
                        hint: `Area = width √ó height.`
                    };
                }

                this.state.currentProblem = problem;
                
                // UI Update for new problem
                const problemEl = document.getElementById('problem-text');
                const idEl = document.getElementById('problem-id');
                const inputEl = document.getElementById('user-answer');
                const feedbackEl = document.getElementById('feedback-msg');
                
                // Fade effect
                problemEl.parentElement.classList.remove('fade-in');
                void problemEl.parentElement.offsetWidth; // trigger reflow
                problemEl.parentElement.classList.add('fade-in');

                problemEl.textContent = problem.text;
                idEl.textContent = this.state.totalSolved + 1;
                inputEl.value = '';
                inputEl.focus();
                feedbackEl.textContent = '';
            },

            // --- Interaction Handling ---
            setTopic: function(topic) {
                this.state.currentTopic = topic;
                
                // Update Button Styles
                ['arithmetic', 'algebra', 'geometry'].forEach(t => {
                    const btn = document.getElementById(`btn-${t}`);
                    if (t === topic) {
                        btn.className = "btn-hover flex flex-col items-center justify-center p-4 rounded-lg border-2 border-indigo-100 bg-indigo-50 text-indigo-700 transition-colors ring-2 ring-indigo-500 ring-offset-2";
                    } else {
                        btn.className = "btn-hover flex flex-col items-center justify-center p-4 rounded-lg border-2 border-slate-100 bg-white text-slate-600 hover:bg-slate-50 transition-colors";
                    }
                });

                // Bot Message
                this.addBotMessage(`Switching focus to <b>${topic.charAt(0).toUpperCase() + topic.slice(1)}</b>. Let's keep the momentum going!`);
                this.generateProblem();
            },

            requestHint: function() {
                const hint = this.state.currentProblem.hint;
                this.addBotMessage(`üí° <b>Hint:</b> ${hint}`);
            },

            submitAnswer: function() {
                const input = document.getElementById('user-answer');
                const val = parseFloat(input.value);
                const feedbackEl = document.getElementById('feedback-msg');

                if (isNaN(val)) {
                    feedbackEl.textContent = "Please enter a number.";
                    feedbackEl.className = "text-sm font-bold text-amber-500";
                    return;
                }

                const correct = Math.abs(val - this.state.currentProblem.answer) < 0.01; // Tolerance for floats

                if (correct) {
                    this.handleSuccess();
                } else {
                    this.handleFailure();
                }
            },

            // --- Game Logic ---
            handleSuccess: function() {
                this.state.streak++;
                this.state.totalSolved++;
                this.state.mastery[this.state.currentTopic]++;
                this.state.history.push(1);
                
                // Adaptive Logic: Increase difficulty every 3 correct answers
                if (this.state.streak % 3 === 0 && this.state.difficulty < 5) {
                    this.state.difficulty++;
                    this.addBotMessage(`üöÄ Outstanding! Increasing difficulty to Level ${this.state.difficulty}.`);
                } else {
                    const praise = ["Great job!", "Correct!", "Spot on!", "Excellent math skills!"];
                    this.addBotMessage(`‚úÖ ${praise[Math.floor(Math.random() * praise.length)]}`);
                }

                this.updateUI();
                this.updateCharts();
                
                // Delay next problem slightly for effect
                setTimeout(() => this.generateProblem(), 1000);
            },

            handleFailure: function() {
                this.state.streak = 0;
                this.state.history.push(0);
                
                const feedbackEl = document.getElementById('feedback-msg');
                feedbackEl.textContent = "Incorrect";
                feedbackEl.className = "text-sm font-bold text-rose-500";

                this.addBotMessage(`‚ùå Not quite. The answer was ${this.state.currentProblem.answer}. Let's try another one.`);
                
                // Adaptive Logic: Decrease difficulty if struggling
                if (this.state.difficulty > 1) {
                    this.state.difficulty--;
                }

                this.updateUI();
                this.updateCharts();
                setTimeout(() => this.generateProblem(), 1500);
            },

            addBotMessage: function(html) {
                const chatArea = document.getElementById('chat-area');
                const msgDiv = document.createElement('div');
                msgDiv.className = "flex gap-4 fade-in";
                msgDiv.innerHTML = `
                    <div class="w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center text-xl flex-shrink-0">ü§ñ</div>
                    <div class="bg-white p-4 rounded-2xl rounded-tl-none shadow-sm border border-slate-200 max-w-[85%]">
                        <p class="text-slate-700">${html}</p>
                    </div>
                `;
                // Insert before the problem card (the last child is the problem card, so insert before it? No, problem card is static)
                // Actually, let's append before the problem card container if we moved it, but simpler to just append to a log container above the card.
                // For this layout, let's just insert before the problem card.
                const problemCard = document.getElementById('problem-card');
                chatArea.insertBefore(msgDiv, problemCard);
                
                // Auto scroll
                chatArea.scrollTop = chatArea.scrollHeight;
            },

            updateUI: function() {
                document.getElementById('global-score').textContent = this.state.totalSolved * 10; // Simple score logic
                document.getElementById('streak-display').textContent = this.state.streak;
                document.getElementById('total-solved-display').textContent = this.state.totalSolved;
                document.getElementById('difficulty-badge').textContent = `Level ${this.state.difficulty}`;
                
                // Trim history to last 10
                if (this.state.history.length > 10) this.state.history.shift();
            },

            // --- Visualization Engine (Chart.js) ---
            initCharts: function() {
                // Velocity Chart (Line)
                const ctxVelocity = document.getElementById('velocityChart').getContext('2d');
                this.velocityChart = new Chart(ctxVelocity, {
                    type: 'line',
                    data: {
                        labels: Array(10).fill(''),
                        datasets: [{
                            label: 'Success Rate (Moving)',
                            data: Array(10).fill(null), // Empty start
                            borderColor: '#4f46e5', // Indigo 600
                            backgroundColor: 'rgba(79, 70, 229, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true,
                            pointRadius: 4,
                            pointBackgroundColor: '#fff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: { beginAtZero: true, max: 1.2, ticks: { display: false }, grid: { display: false } },
                            x: { grid: { display: false } }
                        }
                    }
                });

                // Mastery Chart (Doughnut)
                const ctxMastery = document.getElementById('masteryChart').getContext('2d');
                this.masteryChart = new Chart(ctxMastery, {
                    type: 'doughnut',
                    data: {
                        labels: ['Arithmetic', 'Algebra', 'Geometry'],
                        datasets: [{
                            data: [0, 0, 0], // Init 0
                            backgroundColor: [
                                '#6366f1', // Indigo 500
                                '#ec4899', // Pink 500
                                '#10b981'  // Emerald 500
                            ],
                            borderWidth: 0,
                            hoverOffset: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'bottom', labels: { usePointStyle: true, padding: 20 } }
                        },
                        cutout: '70%'
                    }
                });
            },

            updateCharts: function() {
                // Update Velocity
                // Calculate moving average or just raw correct/incorrect? 
                // Let's visualize the "Accuracy" as a cumulative average of the specific history window.
                const historyData = this.state.history;
                this.velocityChart.data.labels = historyData.map((_, i) => `Q${i+1}`);
                this.velocityChart.data.datasets[0].data = historyData;
                this.velocityChart.update();

                // Update Mastery
                this.masteryChart.data.datasets[0].data = [
                    this.state.mastery.arithmetic,
                    this.state.mastery.algebra,
                    this.state.mastery.geometry
                ];
                // Prevent empty chart looking broken
                if (this.state.totalSolved === 0) {
                     this.masteryChart.data.datasets[0].data = [1, 1, 1];
                     this.masteryChart.data.datasets[0].backgroundColor = ['#e2e8f0', '#e2e8f0', '#e2e8f0'];
                } else {
                     this.masteryChart.data.datasets[0].backgroundColor = ['#6366f1', '#ec4899', '#10b981'];
                }
                this.masteryChart.update();
            }
        };

        // Initialize App
        window.onload = function() {
            app.init();
        };

    </script>
</body>
</html>